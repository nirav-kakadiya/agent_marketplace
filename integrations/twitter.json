{
  "name": "twitter",
  "description": "Post tweets and threads to Twitter/X via API v2",
  "code": "async function execute(input, credentials) {\n  const bearerToken = credentials.TWITTER_BEARER_TOKEN || '';\n  const apiKey = credentials.TWITTER_API_KEY || '';\n  const apiSecret = credentials.TWITTER_API_SECRET || '';\n  const accessToken = credentials.TWITTER_ACCESS_TOKEN || '';\n  const accessSecret = credentials.TWITTER_ACCESS_SECRET || '';\n\n  if (!bearerToken && !accessToken) return { success: false, error: 'TWITTER_BEARER_TOKEN or TWITTER_ACCESS_TOKEN not set' };\n\n  const headers = {\n    'Content-Type': 'application/json',\n    'Authorization': `Bearer ${bearerToken || accessToken}`\n  };\n\n  const { action } = input;\n\n  if (action === 'publish' || action === 'tweet') {\n    const text = input.content || input.text || '';\n    if (!text) return { success: false, error: 'No text provided' };\n\n    // Single tweet\n    if (text.length <= 280 && !input.thread) {\n      const res = await fetch('https://api.twitter.com/2/tweets', {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({ text })\n      });\n      const data = await res.json();\n      if (!res.ok) return { success: false, error: data.detail || data.title || `HTTP ${res.status}` };\n      return { success: true, data: { id: data.data?.id, text: data.data?.text, url: `https://twitter.com/i/status/${data.data?.id}` } };\n    }\n\n    // Thread\n    const tweets = input.thread || text.split('\\n---\\n').filter(t => t.trim());\n    const posted = [];\n    let replyTo = null;\n\n    for (const tweet of tweets) {\n      const body = { text: tweet.trim().substring(0, 280) };\n      if (replyTo) body.reply = { in_reply_to_tweet_id: replyTo };\n\n      const res = await fetch('https://api.twitter.com/2/tweets', {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(body)\n      });\n      const data = await res.json();\n      if (!res.ok) return { success: false, error: data.detail || `HTTP ${res.status}`, partialThread: posted };\n\n      replyTo = data.data?.id;\n      posted.push({ id: data.data?.id, text: data.data?.text, url: `https://twitter.com/i/status/${data.data?.id}` });\n    }\n\n    return { success: true, data: { thread: posted, threadUrl: posted[0]?.url, tweetCount: posted.length } };\n  }\n\n  if (action === 'delete') {\n    const res = await fetch(`https://api.twitter.com/2/tweets/${input.tweetId}`, { method: 'DELETE', headers });\n    return { success: res.ok };\n  }\n\n  return { success: false, error: `Unknown action: ${action}` };\n}",
  "requirements": [
    { "name": "TWITTER_BEARER_TOKEN", "description": "Twitter API v2 Bearer Token", "type": "api_key", "required": true },
    { "name": "TWITTER_ACCESS_TOKEN", "description": "OAuth 1.0a Access Token (for posting)", "type": "api_key", "required": false },
    { "name": "TWITTER_ACCESS_SECRET", "description": "OAuth 1.0a Access Token Secret", "type": "api_key", "required": false }
  ],
  "createdAt": "2026-02-17T13:00:00Z"
}